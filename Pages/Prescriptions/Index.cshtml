@page
@model Roshta.Pages.Prescriptions.IndexModel

@{ 
    ViewData["Title"] = "Prescriptions";
}

<h1>@ViewData["Title"]</h1>

<p>
    <a asp-page="./Create" class="btn btn-success">Create New Prescription</a>
</p>

@if (!Model.PrescriptionList.Any())
{
    <div class="alert alert-info">No prescriptions found.</div>
}
else
{
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.PrescriptionList[0].Patient.Name)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.PrescriptionList[0].Doctor.Name) 
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.PrescriptionList[0].DateIssued)
                </th>
                 <th>
                    @Html.DisplayNameFor(model => model.PrescriptionList[0].ExpiryDate)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.PrescriptionList[0].Status)
                </th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
    @foreach (var item in Model.PrescriptionList) {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.Patient.Name)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Doctor.Name)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.DateIssued)
                </td>
                 <td>
                    @Html.DisplayFor(modelItem => item.ExpiryDate)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Status)
                </td>
                <td>
                    <a asp-page="./Details" asp-route-id="@item.Id" class="btn btn-info btn-sm">Details</a> 
                    @* Edit/Delete might be added later based on status or permissions *
                    @* <a asp-page="./Edit" asp-route-id="@item.Id">Edit</a> | *
                    @* <a asp-page="./Delete" asp-route-id="@item.Id">Delete</a> *@
                </td>
            </tr>
    }
        </tbody>
    </table>
}

@* Display TempData Success Message if present (from Create page) *@
@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success mt-3" role="alert">
        @TempData["SuccessMessage"]
    </div>
} 